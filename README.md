# Лабораторная работа 3

## Задание

Необходимо настроить виртуальную машину А с Ubuntu в Hyper-V.
Обеспечить доступ в сеть Интернет. Осуществить проверку этого доступа и приложить скриншот из терминала.
Следующим шагом настроить ещё одну виртуальную машину Б.
После чего обеспечить сетевой доступ от машины А к машину Б. Приложить скриншот из терминала.
Поднять ещё одну виртуальную машину В. Организовать сетевой доступ:

1. из машины А в машину Б,
2. из машины А в машину В,
3. но запретить доступ из машины Б в машину В,
4. приложить скриншот, на котором видно терминалы всех трёх машин и видно что между машинами есть (или нет) доступа.

### Решение

1. Настройка сети в Hyper-V для связи между ВМ и подключение их к коммутатору.

  Для начала я создаю виртуальный внутренний коммутатор (switch) в разделе "Диспетчер виртуальных коммутаторов" в Hyper-V Manager. Выбираю я внешнюю сеть, хотя сетевой доступ мне нужен только между виртуальными машинами, внешняя сеть предоставляет также доступ в интернет.

![виртуаль коммут](https://github.com/user-attachments/assets/245efaa8-ae0a-45e3-afe4-6306c83b2a66)
  
  Далее в настройках каждой виртуальной машины в разделе "Сеть" я выбираю созданный ранее коммутатор. Так мои машины подключены к одной сети, они могут "видеть" друг друга.

  ![коммутатор](https://github.com/user-attachments/assets/85fb58b9-1bde-4123-9fa3-c92760362a3f)

2. Настройка IP-адресов для ВМ.

  Чтобы виртуальные машины могли обмениваться данными, их IP-адреса должны находиться в одной плоскости.
  С помощью команды "ip a" узнаем адреса каждой машины. Так как я использовала внешней коммутатор, который связан с физическим сетевым адаптером моего хоста, виртуальные машины получили IP-адреса от DHCP-сервера в моей локальной сети (от роутера).
  ВМ_А: 192.168.1.106/24
  ВМ_В: 192.168.1.104/24
  ВМ_С: 192.168.1.109/24
![айпи а](https://github.com/user-attachments/assets/8fef1d35-ccf1-42f4-a3da-c50b9ea46eb8)
![айпи б](https://github.com/user-attachments/assets/d53f2433-62b7-4d81-8ce0-3b07f23519a4)
![айпи с](https://github.com/user-attachments/assets/9c0f4cac-80f9-4f4b-95a0-c5378e67c992)

3. Настройка SSH-доступа между ВМ.

  На этом этапе я устанавливаю и запускаю SSH-сервер, этот сетевой протокол позволит удаленно управлять машинами, передавать файлы и выполнять команды.
  Для того, чтобы настроить доступ из машины А в В - в командной строке машины А выполняю команду "ssh liza_b@192.168.1.104"
  
![ссх а б](https://github.com/user-attachments/assets/d67b2563-bd01-4084-afe7-dc887116fb78)

  Проверяю соединение через команду ping, которая отправляет запрос к машине В, ждет ответа и выводит время, которое заняла эта процедура.
  
![пинг а б](https://github.com/user-attachments/assets/9a398426-1e96-4216-8b97-9ad1b73a0efb)

  То же самое проделываю для соединения машины А с машиной С, проверяю.
  
![схх а с](https://github.com/user-attachments/assets/4384a847-13cc-4359-b467-4d65c4303b97)
![пинг а с](https://github.com/user-attachments/assets/0b030a05-2163-4e97-9bd6-6b1ca3bd8b0e)

4. Ограничение SSH-доступа между ВМ.

   Запрещать доступ я буду через брандмауэр. Для этого я использую утилиту командной строки iptables для настройки правил брандмауэра.
   Для этого я прописываю такую команду в командной строке ВМ_В: "sudo iptables -A INPUT -s 192.168.1.104 -d 192.168.1.109 -j DROP"
   Что здесь прописано:
   sudo iptables - выполняю команду для управления правилами брандмауэра с правами суперпользователя
   -А - Append, добовляю новое правило (не заменяя или удаляя существующие)
   INPUT - цепочка, в которой добавляется правило
   -s 192.168.1.104 - sourse, параметр s указывает на адрес отправителя пакетов, то есть правило будет применяться к пакетам, которые исходят от этого адреса
   -d 192.168.1.109 - destination, параметр d указывает на адрес получателя пакетов
   -j DROP - jump, далее я указываю на действие, которое нужно применить для пакетов. drop - "отбросить", это дейтсвие приведет к игнорированию пакетов, подходящих под условия правила. Они не будут обработаны и не дойдут до получателя, отправитель получит уведомление.

  ![огр ссх б с](https://github.com/user-attachments/assets/70630594-b102-449a-8bf9-03f69c3caeae)

Проверяю

![пинг б с](https://github.com/user-attachments/assets/795abac1-29ff-4d42-89c3-3ac6100ecbd0)

Та даам
